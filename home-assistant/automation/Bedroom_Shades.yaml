- alias: Bedroom Shades
  id: bedroom_shades
  mode: single
  trace:
    stored_traces: 100
  trigger:
    - platform: sun
      event: sunrise
      id: sun_rise
    - platform: sun
      event: sunset
      id: sun_set
    - platform: time
      at: "10:00:00"
      id: daytime
  action:
    - variables:
        bedroom_shade_ids:
          - input_number.cover_basement_east_bedroom_shade_auto_target
          - input_number.cover_basement_master_bedroom_shade_1_auto_target
          - input_number.cover_basement_master_bedroom_shade_2_auto_target
          - input_number.cover_basement_west_bedroom_shade_auto_target
          - input_number.cover_boy_room_shade_1_auto_target
          - input_number.cover_boy_room_shade_2_auto_target
          - input_number.cover_boy_room_shade_3_auto_target
          - input_number.cover_boy_room_shade_4_auto_target
          - input_number.cover_boy_room_shade_5_auto_target
          - input_number.cover_eden_hope_room_shade_1_auto_target
          - input_number.cover_eden_hope_room_shade_2_auto_target
          - input_number.cover_kayleigh_lyra_room_shade_1_auto_target
          - input_number.cover_kayleigh_lyra_room_shade_2_auto_target
          - input_number.cover_kayleigh_lyra_room_shade_3_auto_target
          - input_number.cover_master_bedroom_shade_1_auto_target
          - input_number.cover_master_bedroom_shade_2_auto_target
          - input_number.cover_master_bedroom_shade_3_auto_target
          - input_number.cover_master_bedroom_shade_4_auto_target
          - input_number.cover_master_bedroom_shade_5_auto_target
    - choose:
        - alias: Crack open at sunrise
          conditions:
            - condition: trigger
              id:
                - sun_rise
          sequence:
            - repeat:
                for_each: "{{ bedroom_shade_ids }}"
                sequence:
                  - service: input_number.set_value
                    data:
                      value: 20
                    target:
                      entity_id: "{{ repeat.item }}"
        - alias: Open all the way in late morning
          conditions:
            - condition: trigger
              id:
                - daytime
          sequence:
            - repeat:
                for_each: "{{ bedroom_shade_ids }}"
                sequence:
                  - service: input_number.set_value
                    data:
                      value: 100
                    target:
                      entity_id: "{{ repeat.item }}"
        - alias: Close at sunset
          conditions:
            - condition: trigger
              id:
                - sun_set
          sequence:
            - repeat:
                for_each: "{{ bedroom_shade_ids }}"
                sequence:
                  - service: input_number.set_value
                    data:
                      value: 0
                    target:
                      entity_id: "{{ repeat.item }}"
